var Dt=Object.defineProperty;var Mt=(n,t,e)=>t in n?Dt(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var rt=(n,t,e)=>(Mt(n,typeof t!="symbol"?t+"":t,e),e);import{S as Ct,i as At,s as jt,k as m,q as U,a as N,l as p,m as _,r as X,h as d,c as S,n as u,J as Vt,p as at,b as W,G as c,K as wt,L as ot,M as tt,N as ht,H as dt,O as Nt,P as St,o as Lt,Q as Tt,w as vt}from"../chunks/index.06967d51.js";class _t{constructor(t,e,i,s){this.x0=t,this.y0=e,this.x1=i,this.y1=s}get width(){return this.x1-this.x0}get height(){return this.y1-this.y0}}class z{constructor(t,e){this.re=t,this.im=e}add(t){return new z(this.re+t.re,this.im+t.im)}mul(t){return new z(this.re*t.re-this.im*t.im,this.re*t.im+this.im*t.re)}abs(){return Math.sqrt(this.re*this.re+this.im*this.im)}}class kt{constructor(t,e,i){rt(this,"width",0);rt(this,"height",0);rt(this,"data",[]);this.boundingBox=t,this.maxIterations=e,this.distancePerPixel=i,this.setDistancePerPixel(i)}setDistancePerPixel(t){this.distancePerPixel=t,this.width=Math.ceil(this.boundingBox.width/this.distancePerPixel),this.height=Math.ceil(this.boundingBox.height/this.distancePerPixel),this.data=Array(this.width*this.height)}}class Gt extends kt{constructor(t,e,i,s){super(t,e,i),this.boundingBox=t,this.maxIterations=e,this.distancePerPixel=i,this.c=s}render(){if(this.c===void 0)throw new Error("c cannot be undefined when rendering Julia fractal");for(let t=0;t<this.height;t++)for(let e=0;e<this.width;e++){const i=new z(this.boundingBox.x0+e*this.distancePerPixel,this.boundingBox.y0+t*this.distancePerPixel);this.data[t*this.width+e]=this.juliaIteration(i)}}juliaIteration(t){for(let e=0;e<this.maxIterations;e++)if(t=t.mul(t).add(this.c),t.abs()>2)return e/this.maxIterations;return 1}}class Rt extends kt{constructor(t,e,i){super(t,e,i),this.boundingBox=t,this.maxIterations=e,this.distancePerPixel=i}render(){for(let t=0;t<this.height;t++)for(let e=0;e<this.width;e++){const i=new z(this.boundingBox.x0+e*this.distancePerPixel,this.boundingBox.y0+t*this.distancePerPixel);this.data[t*this.width+e]=this.mandelbrotIteration(i)}}mandelbrotIteration(t){let e=t;for(let i=0;i<this.maxIterations;i++)if(e=e.mul(e).add(t),e.abs()>2)return i/this.maxIterations;return 1}coordFromMousePosition(t,e){const{x0:i,y0:s,x1:r,y1:h}=this.boundingBox,{width:L,height:B}=this,b=i+t/L*(r-i),G=s+e/B*(h-s);return new z(b,G)}}class Y{constructor(t,e,i,s){this.r=t,this.g=e,this.b=i,this.a=s}static fromHex(t,e=255){if(t.startsWith("#")&&(t=t.slice(1)),t.length===3&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),t.length!==6)throw new Error("Invalid hex color");const i=parseInt(t.slice(0,2),16),s=parseInt(t.slice(2,4),16),r=parseInt(t.slice(4,6),16);return new Y(i,s,r,e)}toHex(){return`#${this.r.toString(16)}${this.g.toString(16)}${this.b.toString(16)}`}static fromRGBA(t){t.startsWith("rgba(")&&(t=t.slice(5,-1));const[e,i,s,r]=t.split(",").map(h=>parseInt(h));return new Y(e,i,s,r)}toRGBA(){return`rgba(${this.r}, ${this.g}, ${this.b}, ${this.a})`}invert(){return new Y(255-this.r,255-this.g,255-this.b,this.a)}interpolate(t,e){const i=this.r+(t.r-this.r)*e,s=this.g+(t.g-this.g)*e,r=this.b+(t.b-this.b)*e,h=this.a+(t.a-this.a)*e;return new Y(i,s,r,h)}get values(){return[this.r,this.g,this.b,this.a]}}function q(n){return n.map(t=>Y.fromHex(t))}const lt={Honeydew:q(["e1efe6","efcb68","aeb7b3","000411","d6eaff"]),Blue:q(["03256c","2541b2","1768ac","06bee1","ffffff"]),Volcanic:q(["586f7c","0d1317","bbc5aa","a72608","090c02"]),Spicy:q(["ffffff","f7f7f7","efa00b","d65108","591f0a"]),Sweet:q(["eb5e55","3a3335","d81e5b","fdf0d5","c6d8d3"]),Coquelicot:q(["ffffff","f15025","e6e8e6","ced0ce","191919"])};function Pt(n,t,e){const i=new Uint8ClampedArray(n.length*4);for(let s=0;s<n.length;s++){const r=e?e(n[s]):n[s],h=Ht(r,t);i[s*4+0]=h[0],i[s*4+1]=h[1],i[s*4+2]=h[2],i[s*4+3]=h[3]}return i}function Ht(n,t){let e;const i=t.length-1;for(let s=0;s<i;s++)if(n<=(s+1)/i){e=t[s].interpolate(t[s+1],(n-s/i)*i);break}return(e??t[t.length-1]).values}function xt(n,t,e){const i=n.slice();return i[26]=t[e],i}function It(n){let t,e=n[26]+"",i;return{c(){t=m("option"),i=U(e),this.h()},l(s){t=p(s,"OPTION",{});var r=_(t);i=X(r,e),r.forEach(d),this.h()},h(){t.__value=n[26],t.value=t.__value},m(s,r){W(s,t,r),c(t,i)},p:dt,d(s){s&&d(t)}}}function yt(n){let t,e,i;return{c(){t=m("div"),e=m("p"),i=U("Click on the Mandelbrot set to see the corresponding Julia set"),this.h()},l(s){t=p(s,"DIV",{class:!0});var r=_(t);e=p(r,"P",{});var h=_(e);i=X(h,"Click on the Mandelbrot set to see the corresponding Julia set"),h.forEach(d),r.forEach(d),this.h()},h(){u(t,"class","absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-10 text-center rounded-md bg-white p-4 bg-opacity-20")},m(s,r){W(s,t,r),c(t,e),c(e,i)},d(s){s&&d(t)}}}function Jt(n){let t,e,i,s,r,h,L,B,b,G,k,g,R,l,P,K,E,C,Q,A,w,H,D,j,V,Z,M,F,a,v,T,$,O=Object.keys(lt),x=[];for(let o=0;o<O.length;o+=1)x[o]=It(xt(n,O,o));let y=(!n[6]||!n[6].c)&&yt();return{c(){t=m("h1"),e=U("fractal-friends"),i=N(),s=m("div"),r=m("div"),h=m("label"),L=U("Palette"),B=N(),b=m("select");for(let o=0;o<x.length;o+=1)x[o].c();G=N(),k=m("div"),g=m("label"),R=U("Max iterations"),l=N(),P=m("input"),K=N(),E=m("div"),C=m("label"),Q=U("Color fade:"),A=N(),w=m("input"),H=N(),D=m("div"),j=m("div"),V=m("canvas"),Z=N(),M=m("div"),y&&y.c(),F=N(),a=m("div"),v=m("canvas"),this.h()},l(o){t=p(o,"H1",{class:!0});var I=_(t);e=X(I,"fractal-friends"),I.forEach(d),i=S(o),s=p(o,"DIV",{class:!0});var f=_(s);r=p(f,"DIV",{});var J=_(r);h=p(J,"LABEL",{for:!0});var ft=_(h);L=X(ft,"Palette"),ft.forEach(d),B=S(J),b=p(J,"SELECT",{class:!0,name:!0});var ut=_(b);for(let ct=0;ct<x.length;ct+=1)x[ct].l(ut);ut.forEach(d),J.forEach(d),G=S(f),k=p(f,"DIV",{});var et=_(k);g=p(et,"LABEL",{for:!0});var gt=_(g);R=X(gt,"Max iterations"),gt.forEach(d),l=S(et),P=p(et,"INPUT",{class:!0,type:!0,name:!0}),et.forEach(d),K=S(f),E=p(f,"DIV",{class:!0});var it=_(E);C=p(it,"LABEL",{for:!0});var mt=_(C);Q=X(mt,"Color fade:"),mt.forEach(d),A=S(it),w=p(it,"INPUT",{class:!0,type:!0,min:!0,max:!0,step:!0}),it.forEach(d),f.forEach(d),H=S(o),D=p(o,"DIV",{class:!0});var st=_(D);j=p(st,"DIV",{class:!0});var pt=_(j);V=p(pt,"CANVAS",{class:!0}),_(V).forEach(d),pt.forEach(d),Z=S(st),M=p(st,"DIV",{class:!0});var nt=_(M);y&&y.l(nt),F=S(nt),a=p(nt,"DIV",{class:!0});var bt=_(a);v=p(bt,"CANVAS",{class:!0}),_(v).forEach(d),bt.forEach(d),nt.forEach(d),st.forEach(d),this.h()},h(){u(t,"class","text-center text-xl m-6"),u(h,"for","palette"),u(b,"class","p-1 rounded text-center"),u(b,"name","palette"),n[0]===void 0&&Vt(()=>n[8].call(b)),u(g,"for","maxIters"),u(P,"class","p-1 rounded border border-gray-200 w-20"),u(P,"type","number"),u(P,"name","maxIters"),u(C,"for","curveParam"),u(w,"class","p-1"),u(w,"type","range"),u(w,"min","-1"),u(w,"max","0"),u(w,"step","0.01"),u(E,"class","flex flex-row justify-center space-x-4"),u(s,"class","text-center m-4 space-y-2"),u(V,"class","cursor-pointer self-center"),u(j,"class","flex justify-center align-center m-1 p-2 drop-shadow rounded-md"),at(j,"background-color",n[5][0].toRGBA()),u(v,"class",""),u(a,"class","flex justify-center align-center m-1 p-2 drop-shadow rounded-md self-center"),at(a,"background-color",n[5][0].toRGBA()),u(M,"class","relative justify-center align-center"),u(D,"class","flex flex-row justify-center flex-wrap space-2")},m(o,I){W(o,t,I),c(t,e),W(o,i,I),W(o,s,I),c(s,r),c(r,h),c(h,L),c(r,B),c(r,b);for(let f=0;f<x.length;f+=1)x[f]&&x[f].m(b,null);wt(b,n[0],!0),c(s,G),c(s,k),c(k,g),c(g,R),c(k,l),c(k,P),ot(P,n[1]),c(s,K),c(s,E),c(E,C),c(C,Q),c(E,A),c(E,w),ot(w,n[2]),W(o,H,I),W(o,D,I),c(D,j),c(j,V),n[11](V),c(D,Z),c(D,M),y&&y.m(M,null),c(M,F),c(M,a),c(a,v),n[13](v),T||($=[tt(b,"change",n[8]),tt(P,"input",n[9]),tt(w,"change",n[10]),tt(w,"input",n[10]),tt(V,"click",n[12])],T=!0)},p(o,[I]){if(I&0){O=Object.keys(lt);let f;for(f=0;f<O.length;f+=1){const J=xt(o,O,f);x[f]?x[f].p(J,I):(x[f]=It(J),x[f].c(),x[f].m(b,null))}for(;f<x.length;f+=1)x[f].d(1);x.length=O.length}I&1&&wt(b,o[0]),I&2&&ht(P.value)!==o[1]&&ot(P,o[1]),I&4&&ot(w,o[2]),I&32&&at(j,"background-color",o[5][0].toRGBA()),!o[6]||!o[6].c?y||(y=yt(),y.c(),y.m(M,F)):y&&(y.d(1),y=null),I&32&&at(a,"background-color",o[5][0].toRGBA())},i:dt,o:dt,d(o){o&&d(t),o&&d(i),o&&d(s),Nt(x,o),o&&d(H),o&&d(D),n[11](null),y&&y.d(),n[13](null),T=!1,St($)}}}let Et=.8,Bt=600;function Wt(n,t,e,i="red"){n.strokeStyle=i,n.beginPath(),n.moveTo(t-5,e-5),n.lineTo(t+5,e+5),n.moveTo(t-5,e+5),n.lineTo(t+5,e-5),n.stroke()}function Ft(n,t,e){let i,s,r,h,L=!1,B="Volcanic",b=lt[B];function G(a){e(5,b=lt[a]),L&&(A(!1),l&&l.c&&w(l.c,!1))}const k=new _t(-2,-1.4,1,1.4);let g;const R=new _t(-1.75,-1.75,1.75,1.75);let l,P=50;function K(a){console.log("Updating max iterations"),g&&(g.maxIterations=a,A()),l&&(e(6,l.maxIterations=a,l),l.c&&w(l.c))}let E=-.5,C;function Q(a){C=v=>Math.pow(v,Math.pow(10,a)),g&&A(!1),l&&l.c&&w(l.c,!1)}Lt(()=>{const a=Math.min(window.innerWidth*Et,Bt);s=i.getContext("2d"),g=new Rt(k,P,k.width/a),e(3,i.width=g.width,i),e(3,i.height=g.height,i),h=r.getContext("2d"),e(6,l=new Gt(R,P,R.width/a)),e(4,r.width=l.width,r),e(4,r.height=l.height,r),A(),L=!0,window.addEventListener("resize",()=>{console.log("Resizing");const v=Math.min(window.innerWidth*Et,Bt);g.setDistancePerPixel(k.width/v),A(),e(3,i.width=g.width,i),e(3,i.height=g.height,i),l.setDistancePerPixel(R.width/v),l.c&&w(l.c),e(4,r.width=l.width,r),e(4,r.height=l.height,r)})});function A(a=!0){if(console.log("Drawing mandelbrot"),!s)throw new Error("No mandelbrot context");if(!g)throw new Error("No mandelbrot");a&&g.render();const v=Pt(g.data,b,C),T=s.createImageData(g.width,g.height);T.data.set(v),s.putImageData(T,0,0)}function w(a,v=!0){if(!h)throw new Error("no julia contex");if(e(4,r.width=l.width,r),e(4,r.height=l.height,r),v){if(!a)throw new Error("c must be defined when rerendering");e(6,l.c=a,l),l.render()}const T=Pt(l.data,b,C),$=h.createImageData(l.width,l.height);$.data.set(T),h.putImageData($,0,0)}function H(a){const v=g.coordFromMousePosition(a.offsetX,a.offsetY);console.log("Clicked at",a.offsetX,a.offsetY,"which is",v),s?(A(!1),Wt(s,a.offsetX,a.offsetY)):console.log("No mandelbrot context"),w(v)}function D(){B=Tt(this),e(0,B)}function j(){P=ht(this.value),e(1,P)}function V(){E=ht(this.value),e(2,E)}function Z(a){vt[a?"unshift":"push"](()=>{i=a,e(3,i)})}const M=a=>H(a);function F(a){vt[a?"unshift":"push"](()=>{r=a,e(4,r)})}return n.$$.update=()=>{n.$$.dirty&1&&G(B),n.$$.dirty&2&&K(P),n.$$.dirty&4&&Q(E)},[B,P,E,i,r,b,l,H,D,j,V,Z,M,F]}class Ut extends Ct{constructor(t){super(),At(this,t,Ft,Jt,jt,{})}}export{Ut as default};
